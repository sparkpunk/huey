function makeBlack(scale_by){if(scale_by=='intensity')return{mode:'hsi.i',multiplier:'1'}
if(scale_by=='lightness')return{mode:'hsl.l',multiplier:'.1'}
if(scale_by=='lumi')return{mode:'lch.l',multiplier:'.1'}
if(scale_by=='value')return{mode:'hsv.v',multiplier:'.01'}}
function makeColorScales(color_wheel,scale_by,monochromes){var{mode,multiplier}=makeBlack(scale_by);var huepoint;return color_wheel.map(color=>{var Local_Color=new Color(color);var scale_value=Local_Color[scale_by];var shift_down;var h=Local_Color.hue;if((h>0&&h<=60)||(h>120&&h<=180)||(h>240&&h<=300)){shift_down=true;}else{shift_down=false;}
let white=chroma('#fff').set('hsl.s',0.05);let black=chroma(color).set('hsl.l',0.05);var scale_colors=[white,color,black];var scale_domains=[0,1-scale_value,1];var color_scale=chroma.scale(scale_colors).domain(scale_domains).colors(monochromes*2+1);color_scale=color_scale.filter((hex,i)=>i%2!=0);if(color_scale.indexOf(color)==-1){huepoint=getClosest(scale_value,color_scale,scale_by);huepoint=huepoint.index;}else{huepoint=color_scale.indexOf(color);}
color_scale[huepoint]=color;color_scale=hueShift(color_scale,huepoint,shift_down);return color_scale;})}
function defineColorWheel(num,color){var degree_step=360/num;color=new Color(color);return Array.from({length:num}).map((n,i)=>{if(i==0)return color.hex;var hue=color.hue;var saturation=color.saturation;var value=color.value;var intensity=color.intensity;var local_hue=hue;if(i!=0){local_hue=hue+(degree_step*i);local_hue=local_hue<360?local_hue:local_hue-360;}
return chroma(local_hue,saturation,value,'hsv').hex();});}
function getClosest(num,arr,arg){var current={index:0,color:"#ffffff"};for(var i=0;i<arr.length;i++){var defender=new Color(current.color)[arg];var challenger=new Color(arr[i])[arg];if(Math.abs(num-challenger)<Math.abs(num-defender)){current={index:i,color:arr[i]};};};return current;}
function hueShift(color_scale,huepoint,shift_down){return color_scale.map((color,i)=>{var c=chroma(color);var h=c.get('hsv.h');var s=c.get('hsv.s');var v=c.get('hsv.v');var j=h;var distance=Math.abs(i-huepoint);var multiplier=h/180;var shift_distance=distance*multiplier;var hue_down=h-shift_distance;var hue_up=h+shift_distance;if(shift_down){h=i<huepoint?hue_up:hue_down;}else{h=i<huepoint?hue_down:hue_up;}
var hsv=chroma(h,s,v,'hsv');var hex=hsv.hex();return hex;});}